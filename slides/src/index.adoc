= Aspect Oriented Programming
(aop for firends)
:source-highlighter: highlightjs
:revealjs_theme: league
:revealjs_progress: true
:revealjs_slideNumber: true
:revealjs_history: true
:revealjs_customtheme: css/style.css
:revealjs_showNotes: true

== Wikipedia

Aspect-oriented programming is a programming paradigm that aims to *increase modularity* by alowing the separation of *cross-cutting concerns*.

It does so by adding additional behavior to existing code *without modifying the code* itself.

== Cross-cutting Examples

[%step]
* Caching
* Logging
* Monitoring
* Transaction processing

[NOTE.speaker]
--
Cross-cutting concerns are parts of a program that rely on or must affect many other parts of the system
Actually things aren't that bad
--

== Who can use it ? Nearly eveybody

* AspectJ (Java)
* PostSharp (.NET)
* AspectCobol
* ...

[NOTE.speaker]
--
And we will see AspectJ
--
== Aspect class
[source, java]
----
    public aspect MyAspect { }
----
== Pointcut
[source, java]
----
    execution(void Point.setX(int)) // method body executed
----
[source, java]
----
    call(void Point.setX(int))  // method is called
----
[source, java]
----
    handler(ArrayOutOfBoundsException)  // exception handler
----
[source, java]
----
    within(MyClass)  // executing code belongs to class MyClass
----
[source, java]
----
    this, target, cflow, setter...
----

== Advice
* *before* executed before the Pointcut
* *after* executed after the Pointcut
* *around* that allow to surround the execution

== Demo .aj

[%notitle]
=== 0
[source, xml, numbered]
----
<dependency>
    <groupId>org.aspectj</groupId>
    <artifactId>aspectjrt</artifactId>
    <version>${aspectj}</version>
</dependency>
<dependency>
    <groupId>org.aspectj</groupId>
    <artifactId>aspectjweaver</artifactId>
    <version>${aspectj}</version>
</dependency>
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>aspectj-maven-plugin</artifactId>
    <version>${aspectj-plugin}</version>
</plugin>
----
[%notitle]
=== 1
[source, java, numbered]
----
// Pony.java
package bzh.zomzog.prez.aop;

public class Pony {
    private int distance = 0;

    public boolean makeItWalk(int distance){
        this.distance += distance;
        return true;
    }

    public int getDistance() {
        return distance;
    }
}
----
[%notitle]
=== 2
[source, java, numbered]
----
// Pony.java
package bzh.zomzog.prez.aop;

public class Pony {
    private int distance = 0;

    public boolean makeItWalk(int distance){
        this.distance += distance;
        return true;
    }

    public int getDistance() {
        return distance;
    }
}
----
[%notitle]
=== 3
[source, java, numbered]
----
// PonyAspect.aj
package bzh.zomzog.prez.aop;

public aspect PonyAspect {

    pointcut callMakeItWalk(int distance, Pony pony) :
            call(boolean Pony.makeItWalk(int)) 
            && args(distance) 
            && target(pony);
}
----
[%notitle]
=== 4
[source, java, numbered]
----
before(int distance, Pony pony) : callMakeItWalk(distance, pony) {
    if (distance > 10) {
        throw new RuntimeException("Too long for a pony");
    }
}

after(int distance, Pony pony) : callMakeItWalk(distance, pony) {
    System.out.println("After " + pony);
}
----
[%notitle]
=== 5
[source, java, numbered]
----
boolean around(int distance, Pony pony) 
        : callMakeItWalk(distance, pony) {
    long startTime = System.nanoTime();
    boolean result = proceed(distance, pony);
    long endTime = System.nanoTime();
    System.out.println("Duration : " + (endTime-startTime));
    return result;
}
----

== AspectJ with *java 5*
[source, java]
----
    @Aspect 
    public class MyAspect { }
----
== Pointcut with *java 5*
[source, java]
----
    @Pointcut("execution( ... )")
    public void myExecutionPointcut() { }
----
[source, java]
----
    @Pointcut("@within( AnotherAnnotation )")
    public void myWithinAnnotationPointcut() { }
----

== Advice with *java 5*
[source, java]
----
    @Before("myExecutionPointcut()")
----
[source, java]
----
    @After("myWithinAnnotationPointcut()")
----
[source, java]
----
    @Around("execution( ... )")
----

== Slide Two

Hello World - Good Bye Cruel World

[NOTE.speaker]
--
Actually things aren't that bad
--

[background-color="#25b5f7"]
== Slide Three

Is very blue

[%notitle]
== My great logo

image::https://upload.wikimedia.org/wikipedia/commons/b/b2/Hausziege_04.jpg[canvas,size=contain]


[transition=zoom, %notitle]
== Zoom zoom

This slide will override the presentation transition and zoom!

[transition-speed=fast, %notitle]
== Speed

Choose from three transition speeds: default, fast or slow!

== Slide Four

[%step]
* this
* is
* revealed
* gradually

== Slide Five

Uses highlighted code

[source, python]
----
print "Hello World"
----

== Slide Six

Top slide

=== Slide Six.One

This is a vertical subslide

[state=dynamic]
== Slide Seven js...
